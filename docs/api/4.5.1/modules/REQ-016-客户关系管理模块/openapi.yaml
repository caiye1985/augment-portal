openapi: 3.0.3
info:
  title: IT运维门户系统 API
  version: 1.0.0
  description: REQ-016 客户关系管理模块 API 规范
tags:
- name: customer-profile
  description: 客户档案管理
- name: customer-contacts
  description: 客户联系人管理
- name: customer-contracts
  description: 客户合同管理
- name: customer-health
  description: 客户健康度管理
- name: customer-success
  description: 客户成功管理
- name: customer-communications
  description: 客户沟通管理
- name: customer-analysis
  description: 客户分析
- name: customer-portal
  description: 客户门户
- name: customer-tags
  description: 客户标签管理
- name: customer-segments
  description: 客户细分管理
- name: customer-service
  description: 客户服务记录管理
paths:
  /api/v1/customers:
    post:
      tags:
      - customer-profile
      summary: 创建客户档案
      description: 创建新的客户档案，包括基本信息和联系人信息
      operationId: customer_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerCreateRequest'
      responses:
        '200':
          description: 客户创建成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerCreateResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '409':
          description: 客户信息重复
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    get:
      tags:
      - customer-profile
      summary: 获取客户列表
      description: 分页查询客户列表，支持多条件筛选和排序
      operationId: customer_list
      parameters:
      - name: page
        in: query
        description: 页码，从1开始
        required: false
        schema:
          type: integer
          minimum: 1
          default: 1
          example: 1
      - name: size
        in: query
        description: 每页数量
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          example: 20
      - name: status
        in: query
        description: 客户状态筛选
        required: false
        schema:
          type: array
          items: &id001
            type: string
      - name: level
        in: query
        description: 客户等级筛选
        required: false
        schema:
          type: array
          items: &id002
            type: string
      - name: industry
        in: query
        description: 行业筛选
        required: false
        schema:
          type: string
          example: 软件开发
      - name: assigned_manager_id
        in: query
        description: 客户经理ID筛选
        required: false
        schema:
          type: integer
          format: int64
          example: 1001
      - name: health_score_min
        in: query
        description: 最低健康度评分
        required: false
        schema:
          type: number
          format: float
          minimum: 0
          maximum: 100
          example: 70.0
      - name: health_score_max
        in: query
        description: 最高健康度评分
        required: false
        schema:
          type: number
          format: float
          minimum: 0
          maximum: 100
          example: 100.0
      - name: keyword
        in: query
        description: 关键词搜索（客户名称、编码）
        required: false
        schema:
          type: string
          example: ABC科技
      - name: sort
        in: query
        description: 排序字段
        required: false
        schema:
          type: string
          enum:
          - created_at
          - updated_at
          - health_score
          - ltv
          - next_renewal_date
          default: created_at
          example: health_score
      - name: order
        in: query
        description: 排序方向
        required: false
        schema:
          type: string
          enum:
          - asc
          - desc
          default: desc
          example: desc
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/PagedResponse
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/CustomerListItem'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}:
    get:
      tags:
      - customer-profile
      summary: 获取客户详情
      description: 获取指定客户的详细信息，包括联系人、标签等
      operationId: customer_get_detail
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerDetailResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    put:
      tags:
      - customer-profile
      summary: 更新客户信息
      description: 更新指定客户的基本信息
      operationId: customer_update
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerUpdateRequest'
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/Customer'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '409':
          description: 客户信息重复
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    delete:
      tags:
      - customer-profile
      summary: 删除客户
      description: 删除指定客户（软删除）
      operationId: customer_delete
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      responses:
        '200':
          description: 删除成功
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/search:
    get:
      tags:
      - customer-profile
      summary: 客户搜索
      description: 基于关键词进行客户全文搜索
      operationId: customer_search
      parameters:
      - name: q
        in: query
        description: 搜索关键词
        required: true
        schema:
          type: string
          example: ABC科技
      - name: page
        in: query
        description: 页码，从1开始
        required: false
        schema:
          type: integer
          minimum: 1
          default: 1
          example: 1
      - name: size
        in: query
        description: 每页数量
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          example: 20
      responses:
        '200':
          description: 搜索成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/PagedResponse
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/CustomerListItem'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/batch:
    post:
      tags:
      - customer-profile
      summary: 批量创建客户
      description: 批量创建多个客户档案
      operationId: customer_batch_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                customers:
                  type: array
                  items:
                    $ref: '#/components/schemas/CustomerCreateRequest'
                  example:
                  - customer_name: ABC科技有限公司
                    customer_type: 1
                    industry: 软件开发
                  - customer_name: XYZ制造有限公司
                    customer_type: 1
                    industry: 制造业
      responses:
        '200':
          description: 批量创建成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        success_count:
                          type: integer
                          description: 成功创建数量
                          example: 2
                        failed_count:
                          type: integer
                          description: 失败数量
                          example: 0
                        results:
                          type: array
                          items:
                            type: object
                            properties:
                              index:
                                type: integer
                                description: 原始数组索引
                                example: 0
                              success:
                                type: boolean
                                description: 是否成功
                                example: true
                              customer_id:
                                type: integer
                                format: int64
                                description: 客户ID（成功时）
                                example: 12345
                              error_message:
                                type: string
                                description: 错误信息（失败时）
                                example: null
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    put:
      tags:
      - customer-profile
      summary: 批量更新客户
      description: 批量更新多个客户信息
      operationId: customer_batch_update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                updates:
                  type: array
                  items:
                    allOf:
                    - type: object
                      properties:
                        customer_id:
                          type: integer
                          format: int64
                          description: 客户ID
                          example: 12345
                    - $ref: '#/components/schemas/CustomerUpdateRequest'
      responses:
        '200':
          description: 批量更新成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        success_count:
                          type: integer
                          description: 成功更新数量
                          example: 2
                        failed_count:
                          type: integer
                          description: 失败数量
                          example: 0
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/export:
    get:
      tags:
      - customer-profile
      summary: 导出客户数据
      description: 导出客户数据为Excel文件
      operationId: customer_export
      parameters:
      - name: format
        in: query
        description: 导出格式
        required: false
        schema:
          type: string
          enum:
          - excel
          - csv
          default: excel
          example: excel
      - name: status
        in: query
        description: 客户状态筛选
        required: false
        schema:
          type: array
          items: *id001
      - name: level
        in: query
        description: 客户等级筛选
        required: false
        schema:
          type: array
          items: *id002
      responses:
        '200':
          description: 导出成功
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
            text/csv:
              schema:
                type: string
                format: binary
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/contacts:
    post:
      tags:
      - customer-contacts
      summary: 添加客户联系人
      description: 为指定客户添加新的联系人
      operationId: customer_contact_create
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerContactCreateRequest'
      responses:
        '200':
          description: 联系人添加成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerContact'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    get:
      tags:
      - customer-contacts
      summary: 获取客户联系人列表
      description: 获取指定客户的所有联系人
      operationId: customer_contact_list
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/CustomerContact'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/contacts/{contactId}:
    put:
      tags:
      - customer-contacts
      summary: 更新客户联系人
      description: 更新指定客户的联系人信息
      operationId: customer_contact_update
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: contactId
        in: path
        description: 联系人ID
        required: true
        schema:
          type: integer
          format: int64
          example: 1001
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerContactUpdateRequest'
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerContact'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户或联系人不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    delete:
      tags:
      - customer-contacts
      summary: 删除客户联系人
      description: 删除指定客户的联系人
      operationId: customer_contact_delete
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: contactId
        in: path
        description: 联系人ID
        required: true
        schema:
          type: integer
          format: int64
          example: 1001
      responses:
        '200':
          description: 删除成功
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户或联系人不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/contacts/{contactId}/primary:
    put:
      tags:
      - customer-contacts
      summary: 设置主联系人
      description: 将指定联系人设置为客户的主联系人
      operationId: customer_contact_set_primary
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: contactId
        in: path
        description: 联系人ID
        required: true
        schema:
          type: integer
          format: int64
          example: 1001
      responses:
        '200':
          description: 设置成功
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '403':
          description: 权限不足
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户或联系人不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/health-score/calculate:
    post:
      tags:
      - customer-health
      summary: 计算客户健康度
      description: 基于AI算法计算指定客户的健康度评分
      operationId: customer_health_score_calculate
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      responses:
        '200':
          description: 健康度计算成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerHealthScoreResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 健康度计算失败
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/health-score:
    get:
      tags:
      - customer-health
      summary: 获取客户健康度
      description: 获取指定客户的当前健康度评分
      operationId: customer_health_score_get
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerHealthScore'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/health-score/trend:
    get:
      tags:
      - customer-health
      summary: 获取客户健康度趋势
      description: 获取指定客户的健康度历史趋势数据
      operationId: customer_health_score_trend
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: period
        in: query
        description: 时间周期
        required: false
        schema:
          type: string
          enum:
          - 1m
          - 3m
          - 6m
          - 1y
          default: 6m
          example: 6m
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerHealthScoreTrendResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/success-tasks:
    post:
      tags:
      - customer-success
      summary: 创建客户成功任务
      description: 为指定客户创建客户成功任务
      operationId: customer_success_task_create
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerSuccessTaskCreateRequest'
      responses:
        '200':
          description: 任务创建成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerSuccessTask'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/success-tasks:
    get:
      tags:
      - customer-success
      summary: 获取客户成功任务列表
      description: 分页查询客户成功任务列表，支持筛选
      operationId: customer_success_task_list
      parameters:
      - name: assigned_to
        in: query
        description: 分配给（员工ID）
        required: false
        schema:
          type: integer
          format: int64
          example: 1001
      - name: status
        in: query
        description: 任务状态筛选
        required: false
        schema:
          type: array
          items: *id001
      - name: priority
        in: query
        description: 优先级筛选
        required: false
        schema:
          type: array
          items:
            type: string
      - name: task_type
        in: query
        description: 任务类型筛选
        required: false
        schema:
          type: array
          items:
            type: string
      - name: page
        in: query
        description: 页码，从1开始
        required: false
        schema:
          type: integer
          minimum: 1
          default: 1
          example: 1
      - name: size
        in: query
        description: 每页数量
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          example: 20
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/PagedResponse
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/CustomerSuccessTaskListItem'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/contracts:
    post:
      tags:
      - customer-contracts
      summary: 创建客户合同
      description: 为指定客户创建新的合同
      operationId: customer_contract_create
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerContractCreateRequest'
      responses:
        '200':
          description: 合同创建成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerContract'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    get:
      tags:
      - customer-contracts
      summary: 获取客户合同列表
      description: 获取指定客户的所有合同
      operationId: customer_contract_list
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: status
        in: query
        description: 合同状态筛选
        required: false
        schema:
          type: array
          items: *id001
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/CustomerContract'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/contracts/{id}:
    get:
      tags:
      - customer-contracts
      summary: 获取合同详情
      description: 获取指定合同的详细信息
      operationId: customer_contract_get_detail
      parameters:
      - name: id
        in: path
        description: 合同ID
        required: true
        schema:
          type: integer
          format: int64
          example: 10001
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerContract'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 合同不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    put:
      tags:
      - customer-contracts
      summary: 更新合同信息
      description: 更新指定合同的信息
      operationId: customer_contract_update
      parameters:
      - name: id
        in: path
        description: 合同ID
        required: true
        schema:
          type: integer
          format: int64
          example: 10001
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerContractUpdateRequest'
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerContract'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 合同不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/contracts/{id}/renew:
    post:
      tags:
      - customer-contracts
      summary: 续约合同
      description: 对指定合同进行续约操作
      operationId: customer_contract_renew
      parameters:
      - name: id
        in: path
        description: 合同ID
        required: true
        schema:
          type: integer
          format: int64
          example: 10001
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContractRenewalRequest'
      responses:
        '200':
          description: 续约成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerContract'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 合同不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/contracts/expiring:
    get:
      tags:
      - customer-contracts
      summary: 获取即将到期合同
      description: 获取即将到期的合同列表
      operationId: customer_contract_expiring
      parameters:
      - name: days
        in: query
        description: 提前天数
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 365
          default: 90
          example: 90
      - name: page
        in: query
        description: 页码，从1开始
        required: false
        schema:
          type: integer
          minimum: 1
          default: 1
          example: 1
      - name: size
        in: query
        description: 每页数量
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          example: 20
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/PagedResponse
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/CustomerContract'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/analysis/value:
    get:
      tags:
      - customer-analysis
      summary: 客户价值分析
      description: 获取指定客户的价值分析报告
      operationId: customer_analysis_value
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      responses:
        '200':
          description: 分析成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerValueAnalysisResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/analysis/behavior:
    get:
      tags:
      - customer-analysis
      summary: 客户行为分析
      description: 获取指定客户的行为分析报告
      operationId: customer_analysis_behavior
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: period
        in: query
        description: 分析周期
        required: false
        schema:
          type: string
          enum:
          - 1m
          - 3m
          - 6m
          - 1y
          default: 3m
          example: 3m
      responses:
        '200':
          description: 分析成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerBehaviorAnalysisResponse'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/tags:
    post:
      tags:
      - customer-tags
      summary: 添加客户标签
      description: 为指定客户添加标签
      operationId: customer_tag_create
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerTagCreateRequest'
      responses:
        '200':
          description: 标签添加成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerTag'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    get:
      tags:
      - customer-tags
      summary: 获取客户标签
      description: 获取指定客户的所有标签
      operationId: customer_tag_list
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/CustomerTag'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/tags/{tagId}:
    delete:
      tags:
      - customer-tags
      summary: 删除客户标签
      description: 删除指定客户的标签
      operationId: customer_tag_delete
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: tagId
        in: path
        description: 标签ID
        required: true
        schema:
          type: integer
          format: int64
          example: 2001
      responses:
        '200':
          description: 删除成功
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户或标签不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/communications:
    post:
      tags:
      - customer-communications
      summary: 创建沟通记录
      description: 为指定客户创建沟通记录
      operationId: customer_communication_create
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerCommunicationCreateRequest'
      responses:
        '200':
          description: 沟通记录创建成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerCommunication'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
    get:
      tags:
      - customer-communications
      summary: 获取沟通记录列表
      description: 获取指定客户的沟通记录列表
      operationId: customer_communication_list
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: communication_type
        in: query
        description: 沟通类型筛选
        required: false
        schema:
          type: array
          items:
            type: integer
            enum:
            - 1
            - 2
            - 3
            - 4
          example:
          - 1
          - 2
      - name: page
        in: query
        description: 页码，从1开始
        required: false
        schema:
          type: integer
          minimum: 1
          default: 1
          example: 1
      - name: size
        in: query
        description: 每页数量
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          example: 20
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/PagedResponse
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/CustomerCommunication'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/service-records:
    get:
      tags:
      - customer-service
      summary: 获取客户服务记录
      description: 获取指定客户的服务记录列表
      operationId: customer_service_record_list
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: start_date
        in: query
        description: 开始日期
        required: false
        schema:
          type: string
          format: date
          example: '2025-01-01'
      - name: end_date
        in: query
        description: 结束日期
        required: false
        schema:
          type: string
          format: date
          example: '2025-08-15'
      - name: page
        in: query
        description: 页码，从1开始
        required: false
        schema:
          type: integer
          minimum: 1
          default: 1
          example: 1
      - name: size
        in: query
        description: 每页数量
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          example: 20
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/PagedResponse
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/CustomerServiceRecord'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
  /api/v1/customers/{id}/satisfaction:
    get:
      tags:
      - customer-service
      summary: 获取客户满意度数据
      description: 获取指定客户的满意度统计数据
      operationId: customer_satisfaction_get
      parameters:
      - name: id
        in: path
        description: 客户ID
        required: true
        schema:
          type: integer
          format: int64
          example: 12345
      - name: period
        in: query
        description: 统计周期
        required: false
        schema:
          type: string
          enum:
          - 1m
          - 3m
          - 6m
          - 1y
          default: 3m
          example: 3m
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                - $ref: ../../global-api-index.yaml#/components/schemas/ApiResponse
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/CustomerSatisfactionData'
        '400':
          description: 请求参数错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '401':
          description: 未授权
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '404':
          description: 客户不存在
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: ../../global-api-index.yaml#/components/schemas/ErrorResponse
components:
  schemas:
    Customer:
      type: object
      description: 客户档案信息
      properties:
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        tenant_id:
          type: integer
          format: int64
          description: 租户ID
          example: 1
        customer_code:
          type: string
          description: 客户编码
          example: CUST-20250815-0001
        customer_name:
          type: string
          description: 客户名称
          example: ABC科技有限公司
        customer_type:
          type: integer
          description: 客户类型：1-企业，2-政府，3-个人
          enum:
          - 1
          - 2
          - 3
          example: 1
        industry:
          type: string
          description: 所属行业
          example: 软件开发
        scale:
          type: string
          description: 企业规模
          example: 中型企业
        address:
          type: string
          description: 客户地址
          example: 北京市朝阳区xxx路xxx号
        website:
          type: string
          format: uri
          description: 官方网站
          example: https://www.abc-tech.com
        description:
          type: string
          description: 客户描述
          example: 专注于企业级软件开发的科技公司
        status:
          type: integer
          description: 状态：1-潜在客户，2-正式客户，3-流失客户
          enum:
          - 1
          - 2
          - 3
          example: 2
        level:
          type: integer
          description: 客户等级：1-普通，2-重要，3-VIP，4-战略
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 3
        source:
          type: string
          description: 客户来源
          example: 网络推广
        assigned_manager_id:
          type: integer
          format: int64
          description: 客户经理ID
          example: 1001
        health_score:
          type: number
          format: float
          description: 健康度评分
          minimum: 0
          maximum: 100
          example: 85.5
        ltv:
          type: number
          format: float
          description: 客户生命周期价值
          example: 360000.0
        last_contact_date:
          type: string
          format: date-time
          description: 最后联系时间
          example: '2025-08-10T15:30:00Z'
        next_renewal_date:
          type: string
          format: date
          description: 下次续约时间
          example: '2025-12-31'
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: '2025-08-15T10:30:00Z'
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: '2025-08-15T14:30:00Z'
    CustomerCreateRequest:
      type: object
      description: 创建客户请求
      required:
      - customer_name
      - customer_type
      properties:
        customer_name:
          type: string
          description: 客户名称
          minLength: 1
          maxLength: 200
          example: ABC科技有限公司
        customer_type:
          type: integer
          description: 客户类型：1-企业，2-政府，3-个人
          enum:
          - 1
          - 2
          - 3
          example: 1
        industry:
          type: string
          description: 所属行业
          maxLength: 100
          example: 软件开发
        scale:
          type: string
          description: 企业规模
          maxLength: 50
          example: 中型企业
        address:
          type: string
          description: 客户地址
          example: 北京市朝阳区xxx路xxx号
        website:
          type: string
          format: uri
          description: 官方网站
          example: https://www.abc-tech.com
        description:
          type: string
          description: 客户描述
          example: 专注于企业级软件开发的科技公司
        level:
          type: integer
          description: 客户等级：1-普通，2-重要，3-VIP，4-战略
          enum:
          - 1
          - 2
          - 3
          - 4
          default: 1
          example: 2
        source:
          type: string
          description: 客户来源
          maxLength: 50
          example: 网络推广
        assigned_manager_id:
          type: integer
          format: int64
          description: 客户经理ID
          example: 1001
        contacts:
          type: array
          description: 联系人列表
          items:
            $ref: '#/components/schemas/CustomerContactCreateRequest'
    CustomerUpdateRequest:
      type: object
      description: 更新客户请求
      properties:
        customer_name:
          type: string
          description: 客户名称
          minLength: 1
          maxLength: 200
          example: ABC科技有限公司
        customer_type:
          type: integer
          description: 客户类型：1-企业，2-政府，3-个人
          enum:
          - 1
          - 2
          - 3
          example: 1
        industry:
          type: string
          description: 所属行业
          maxLength: 100
          example: 软件开发
        scale:
          type: string
          description: 企业规模
          maxLength: 50
          example: 中型企业
        address:
          type: string
          description: 客户地址
          example: 北京市朝阳区xxx路xxx号
        website:
          type: string
          format: uri
          description: 官方网站
          example: https://www.abc-tech.com
        description:
          type: string
          description: 客户描述
          example: 专注于企业级软件开发的科技公司
        status:
          type: integer
          description: 状态：1-潜在客户，2-正式客户，3-流失客户
          enum:
          - 1
          - 2
          - 3
          example: 2
        level:
          type: integer
          description: 客户等级：1-普通，2-重要，3-VIP，4-战略
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 3
        source:
          type: string
          description: 客户来源
          maxLength: 50
          example: 网络推广
        assigned_manager_id:
          type: integer
          format: int64
          description: 客户经理ID
          example: 1001
    CustomerCreateResponse:
      type: object
      description: 创建客户响应
      properties:
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        customer_code:
          type: string
          description: 客户编码
          example: CUST-20250815-0001
        customer_name:
          type: string
          description: 客户名称
          example: ABC科技有限公司
        status:
          type: integer
          description: 状态
          example: 1
        health_score:
          type: number
          format: float
          description: 健康度评分
          example: 75.0
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: '2025-08-15T14:30:00Z'
    CustomerListItem:
      type: object
      description: 客户列表项
      properties:
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        customer_code:
          type: string
          description: 客户编码
          example: CUST-20250815-0001
        customer_name:
          type: string
          description: 客户名称
          example: ABC科技有限公司
        customer_type:
          type: integer
          description: 客户类型
          example: 1
        industry:
          type: string
          description: 所属行业
          example: 软件开发
        level:
          type: integer
          description: 客户等级
          example: 3
        status:
          type: integer
          description: 状态
          example: 2
        health_score:
          type: number
          format: float
          description: 健康度评分
          example: 85.5
        ltv:
          type: number
          format: float
          description: 客户生命周期价值
          example: 360000.0
        assigned_manager:
          type: object
          description: 客户经理信息
          properties:
            id:
              type: integer
              format: int64
              example: 1001
            name:
              type: string
              example: 李经理
        last_contact_date:
          type: string
          format: date-time
          description: 最后联系时间
          example: '2025-08-10T15:30:00Z'
        next_renewal_date:
          type: string
          format: date
          description: 下次续约时间
          example: '2025-12-31'
    CustomerDetailResponse:
      type: object
      description: 客户详情响应
      properties:
        customer_info:
          $ref: '#/components/schemas/Customer'
        contacts:
          type: array
          description: 联系人列表
          items:
            $ref: '#/components/schemas/CustomerContact'
        tags:
          type: array
          description: 客户标签
          items:
            $ref: '#/components/schemas/CustomerTag'
    CustomerContact:
      type: object
      description: 客户联系人信息
      properties:
        contact_id:
          type: integer
          format: int64
          description: 联系人ID
          example: 1001
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        contact_name:
          type: string
          description: 联系人姓名
          example: 张总
        position:
          type: string
          description: 职位
          example: 总经理
        department:
          type: string
          description: 部门
          example: 管理层
        phone:
          type: string
          description: 电话
          example: 010-12345678
        mobile:
          type: string
          description: 手机
          example: '13800138000'
        email:
          type: string
          format: email
          description: 邮箱
          example: zhang@abc-tech.com
        wechat:
          type: string
          description: 微信
          example: zhang_ceo
        is_primary:
          type: integer
          description: 是否主要联系人：0-否，1-是
          enum:
          - 0
          - 1
          example: 1
        is_decision_maker:
          type: integer
          description: 是否决策人：0-否，1-是
          enum:
          - 0
          - 1
          example: 1
        influence_level:
          type: integer
          description: 影响力等级：1-低，2-中，3-高
          enum:
          - 1
          - 2
          - 3
          example: 3
        last_contact_date:
          type: string
          format: date-time
          description: 最后联系时间
          example: '2025-08-10T15:30:00Z'
        contact_preference:
          type: string
          description: 联系偏好
          example: 邮件
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: '2025-08-15T10:30:00Z'
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: '2025-08-15T14:30:00Z'
    CustomerContactCreateRequest:
      type: object
      description: 创建联系人请求
      required:
      - contact_name
      properties:
        contact_name:
          type: string
          description: 联系人姓名
          minLength: 1
          maxLength: 100
          example: 张总
        position:
          type: string
          description: 职位
          maxLength: 100
          example: 总经理
        department:
          type: string
          description: 部门
          maxLength: 100
          example: 管理层
        phone:
          type: string
          description: 电话
          maxLength: 20
          example: 010-12345678
        mobile:
          type: string
          description: 手机
          maxLength: 20
          example: '13800138000'
        email:
          type: string
          format: email
          description: 邮箱
          maxLength: 100
          example: zhang@abc-tech.com
        wechat:
          type: string
          description: 微信
          maxLength: 100
          example: zhang_ceo
        is_primary:
          type: integer
          description: 是否主要联系人：0-否，1-是
          enum:
          - 0
          - 1
          default: 0
          example: 1
        is_decision_maker:
          type: integer
          description: 是否决策人：0-否，1-是
          enum:
          - 0
          - 1
          default: 0
          example: 1
        influence_level:
          type: integer
          description: 影响力等级：1-低，2-中，3-高
          enum:
          - 1
          - 2
          - 3
          default: 1
          example: 3
        contact_preference:
          type: string
          description: 联系偏好
          maxLength: 50
          example: 邮件
    CustomerContactUpdateRequest:
      type: object
      description: 更新联系人请求
      properties:
        contact_name:
          type: string
          description: 联系人姓名
          minLength: 1
          maxLength: 100
          example: 张总
        position:
          type: string
          description: 职位
          maxLength: 100
          example: 总经理
        department:
          type: string
          description: 部门
          maxLength: 100
          example: 管理层
        phone:
          type: string
          description: 电话
          maxLength: 20
          example: 010-12345678
        mobile:
          type: string
          description: 手机
          maxLength: 20
          example: '13800138000'
        email:
          type: string
          format: email
          description: 邮箱
          maxLength: 100
          example: zhang@abc-tech.com
        wechat:
          type: string
          description: 微信
          maxLength: 100
          example: zhang_ceo
        is_decision_maker:
          type: integer
          description: 是否决策人：0-否，1-是
          enum:
          - 0
          - 1
          example: 1
        influence_level:
          type: integer
          description: 影响力等级：1-低，2-中，3-高
          enum:
          - 1
          - 2
          - 3
          example: 3
        contact_preference:
          type: string
          description: 联系偏好
          maxLength: 50
          example: 邮件
    CustomerHealthScore:
      type: object
      description: 客户健康度信息
      properties:
        id:
          type: integer
          format: int64
          description: 健康度记录ID
          example: 5001
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        score_date:
          type: string
          format: date
          description: 评分日期
          example: '2025-08-15'
        overall_score:
          type: number
          format: float
          description: 总体健康度评分
          minimum: 0
          maximum: 100
          example: 85.5
        satisfaction_score:
          type: number
          format: float
          description: 满意度评分
          minimum: 0
          maximum: 100
          example: 88.0
        activity_score:
          type: number
          format: float
          description: 活跃度评分
          minimum: 0
          maximum: 100
          example: 82.0
        financial_score:
          type: number
          format: float
          description: 财务健康度评分
          minimum: 0
          maximum: 100
          example: 90.0
        contract_score:
          type: number
          format: float
          description: 合同稳定性评分
          minimum: 0
          maximum: 100
          example: 83.0
        risk_level:
          type: integer
          description: 风险等级：1-低，2-中，3-高，4-极高
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 1
        churn_probability:
          type: number
          format: float
          description: 流失概率
          minimum: 0
          maximum: 1
          example: 0.085
        factors:
          type: object
          description: 影响因素详情
          properties:
            positive_factors:
              type: array
              description: 正面因素
              items:
                type: string
              example:
              - 付款及时性良好
              - 服务满意度高
              - 使用频率稳定
            negative_factors:
              type: array
              description: 负面因素
              items:
                type: string
              example:
              - 近期登录频率下降
              - 工单数量增加
        recommendations:
          type: array
          description: 改进建议
          items:
            type: string
          example:
          - 建议主动联系客户了解使用情况
          - 提供产品使用培训
          - 关注工单处理质量
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: '2025-08-15T10:30:00Z'
    CustomerHealthScoreResponse:
      type: object
      description: 客户健康度计算响应
      properties:
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        score_date:
          type: string
          format: date
          description: 评分日期
          example: '2025-08-15'
        overall_score:
          type: number
          format: float
          description: 总体健康度评分
          example: 85.5
        satisfaction_score:
          type: number
          format: float
          description: 满意度评分
          example: 88.0
        activity_score:
          type: number
          format: float
          description: 活跃度评分
          example: 82.0
        financial_score:
          type: number
          format: float
          description: 财务健康度评分
          example: 90.0
        contract_score:
          type: number
          format: float
          description: 合同稳定性评分
          example: 83.0
        risk_level:
          type: integer
          description: 风险等级
          example: 1
        churn_probability:
          type: number
          format: float
          description: 流失概率
          example: 0.085
        factors:
          type: object
          description: 影响因素详情
          properties:
            positive_factors:
              type: array
              items:
                type: string
              example:
              - 付款及时性良好
              - 服务满意度高
              - 使用频率稳定
            negative_factors:
              type: array
              items:
                type: string
              example:
              - 近期登录频率下降
              - 工单数量增加
        recommendations:
          type: array
          description: 改进建议
          items:
            type: string
          example:
          - 建议主动联系客户了解使用情况
          - 提供产品使用培训
          - 关注工单处理质量
    CustomerHealthScoreTrendResponse:
      type: object
      description: 客户健康度趋势响应
      properties:
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        period:
          type: string
          description: 时间周期
          example: 6m
        trend_data:
          type: array
          description: 趋势数据
          items:
            type: object
            properties:
              score_date:
                type: string
                format: date
                description: 评分日期
                example: '2025-03-15'
              overall_score:
                type: number
                format: float
                description: 总体健康度评分
                example: 78.5
              risk_level:
                type: integer
                description: 风险等级
                example: 2
        trend_analysis:
          type: object
          description: 趋势分析
          properties:
            direction:
              type: string
              description: 趋势方向
              enum:
              - 上升
              - 下降
              - 稳定
              example: 上升
            change_rate:
              type: number
              format: float
              description: 变化率
              example: 0.089
            stability:
              type: string
              description: 稳定性
              enum:
              - 稳定
              - 波动
              - 剧烈波动
              example: 稳定
    CustomerTag:
      type: object
      description: 客户标签信息
      properties:
        tag_id:
          type: integer
          format: int64
          description: 标签ID
          example: 2001
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        tag_name:
          type: string
          description: 标签名称
          example: 高价值客户
        tag_type:
          type: integer
          description: 标签类型：1-手动，2-自动，3-系统
          enum:
          - 1
          - 2
          - 3
          example: 2
        tag_category:
          type: string
          description: 标签分类
          example: 价值分类
        tag_value:
          type: string
          description: 标签值
          example: VIP
        confidence:
          type: number
          format: float
          description: 置信度（自动标签）
          minimum: 0
          maximum: 1
          example: 0.95
        created_by:
          type: integer
          format: int64
          description: 创建人
          example: 1001
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: '2025-08-15T10:30:00Z'
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: '2025-08-15T14:30:00Z'
    CustomerSuccessTask:
      type: object
      description: 客户成功任务信息
      properties:
        task_id:
          type: integer
          format: int64
          description: 任务ID
          example: 5001
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        task_title:
          type: string
          description: 任务标题
          example: 客户健康度改善计划
        task_description:
          type: string
          description: 任务描述
          example: 针对客户健康度下降，制定改善计划
        task_type:
          type: integer
          description: 任务类型：1-健康度改善，2-续约跟进，3-满意度提升，4-问题解决
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 1
        priority:
          type: integer
          description: 优先级：1-低，2-中，3-高，4-紧急
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 3
        status:
          type: integer
          description: 状态：1-待处理，2-进行中，3-已完成，4-已取消
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 1
        assigned_to:
          type: integer
          format: int64
          description: 分配给
          example: 1001
        due_date:
          type: string
          format: date-time
          description: 截止时间
          example: '2025-08-25T18:00:00Z'
        completion_date:
          type: string
          format: date-time
          description: 完成时间
          example: null
        result:
          type: string
          description: 执行结果
          example: null
        effectiveness_score:
          type: number
          format: float
          description: 效果评分
          minimum: 0
          maximum: 5
          example: null
        auto_generated:
          type: integer
          description: 是否自动生成：0-否，1-是
          enum:
          - 0
          - 1
          example: 0
        trigger_condition:
          type: string
          description: 触发条件
          example: null
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: '2025-08-15T16:00:00Z'
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: '2025-08-15T16:00:00Z'
    CustomerSuccessTaskCreateRequest:
      type: object
      description: 创建客户成功任务请求
      required:
      - task_title
      - task_type
      - assigned_to
      properties:
        task_title:
          type: string
          description: 任务标题
          minLength: 1
          maxLength: 200
          example: 客户健康度改善计划
        task_description:
          type: string
          description: 任务描述
          example: 针对客户健康度下降，制定改善计划
        task_type:
          type: integer
          description: 任务类型：1-健康度改善，2-续约跟进，3-满意度提升，4-问题解决
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 1
        priority:
          type: integer
          description: 优先级：1-低，2-中，3-高，4-紧急
          enum:
          - 1
          - 2
          - 3
          - 4
          default: 2
          example: 3
        assigned_to:
          type: integer
          format: int64
          description: 分配给
          example: 1001
        due_date:
          type: string
          format: date-time
          description: 截止时间
          example: '2025-08-25T18:00:00Z'
    CustomerSuccessTaskListItem:
      type: object
      description: 客户成功任务列表项
      properties:
        task_id:
          type: integer
          format: int64
          description: 任务ID
          example: 5001
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        customer_name:
          type: string
          description: 客户名称
          example: ABC科技有限公司
        task_title:
          type: string
          description: 任务标题
          example: 客户健康度改善计划
        task_type:
          type: integer
          description: 任务类型
          example: 1
        priority:
          type: integer
          description: 优先级
          example: 3
        status:
          type: integer
          description: 状态
          example: 1
        due_date:
          type: string
          format: date-time
          description: 截止时间
          example: '2025-08-25T18:00:00Z'
        auto_generated:
          type: integer
          description: 是否自动生成
          example: 0
    CustomerValueAnalysisResponse:
      type: object
      description: 客户价值分析响应
      properties:
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        value_analysis:
          type: object
          description: 价值分析
          properties:
            ltv:
              type: number
              format: float
              description: 客户生命周期价值
              example: 360000.0
            arpu:
              type: number
              format: float
              description: 用户平均收入
              example: 10000.0
            profit_margin:
              type: number
              format: float
              description: 利润率
              example: 0.35
            revenue_trend:
              type: string
              description: 收入趋势
              enum:
              - 上升
              - 下降
              - 稳定
              example: 上升
            value_rank:
              type: string
              description: 价值排名
              example: 前10%
        financial_metrics:
          type: object
          description: 财务指标
          properties:
            total_revenue:
              type: number
              format: float
              description: 总收入
              example: 120000.0
            monthly_revenue:
              type: number
              format: float
              description: 月收入
              example: 10000.0
            payment_punctuality:
              type: number
              format: float
              description: 付款及时性
              minimum: 0
              maximum: 1
              example: 0.95
            contract_stability:
              type: number
              format: float
              description: 合同稳定性
              minimum: 0
              maximum: 1
              example: 0.88
        growth_potential:
          type: object
          description: 增长潜力
          properties:
            upsell_probability:
              type: number
              format: float
              description: 向上销售概率
              minimum: 0
              maximum: 1
              example: 0.75
            expansion_opportunities:
              type: array
              description: 扩展机会
              items:
                type: string
              example:
              - 增加用户数量
              - 升级服务等级
              - 购买附加模块
            estimated_growth:
              type: number
              format: float
              description: 预估增长率
              example: 0.3
    CustomerContract:
      type: object
      description: 客户合同信息
      properties:
        contract_id:
          type: integer
          format: int64
          description: 合同ID
          example: 10001
        tenant_id:
          type: integer
          format: int64
          description: 租户ID
          example: 1
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        contract_code:
          type: string
          description: 合同编号
          example: CONT-20250815-0001
        contract_name:
          type: string
          description: 合同名称
          example: IT运维服务合同
        contract_type:
          type: integer
          description: 合同类型：1-服务合同，2-采购合同，3-框架协议
          enum:
          - 1
          - 2
          - 3
          example: 1
        contract_amount:
          type: number
          format: float
          description: 合同金额
          example: 120000.0
        currency:
          type: string
          description: 币种
          default: CNY
          example: CNY
        start_date:
          type: string
          format: date
          description: 合同开始日期
          example: '2025-01-01'
        end_date:
          type: string
          format: date
          description: 合同结束日期
          example: '2025-12-31'
        status:
          type: integer
          description: 状态：1-草稿，2-生效，3-到期，4-终止
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 2
        renewal_type:
          type: integer
          description: 续约类型：1-手动，2-自动
          enum:
          - 1
          - 2
          example: 1
        renewal_notice_days:
          type: integer
          description: 续约提醒天数
          default: 90
          example: 90
        payment_terms:
          type: string
          description: 付款条件
          example: 月付
        service_level:
          type: string
          description: 服务等级
          example: 专业版
        contract_file_url:
          type: string
          format: uri
          description: 合同文件URL
          example: https://cdn.example.com/contracts/CONT-20250815-0001.pdf
        signed_date:
          type: string
          format: date
          description: 签署日期
          example: '2024-12-15'
        created_by:
          type: integer
          format: int64
          description: 创建人
          example: 1001
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: '2024-12-15T10:30:00Z'
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: '2025-08-15T14:30:00Z'
    CustomerContractCreateRequest:
      type: object
      description: 创建客户合同请求
      required:
      - contract_name
      - contract_type
      - contract_amount
      - start_date
      - end_date
      properties:
        contract_name:
          type: string
          description: 合同名称
          minLength: 1
          maxLength: 200
          example: IT运维服务合同
        contract_type:
          type: integer
          description: 合同类型：1-服务合同，2-采购合同，3-框架协议
          enum:
          - 1
          - 2
          - 3
          example: 1
        contract_amount:
          type: number
          format: float
          description: 合同金额
          minimum: 0
          example: 120000.0
        currency:
          type: string
          description: 币种
          default: CNY
          example: CNY
        start_date:
          type: string
          format: date
          description: 合同开始日期
          example: '2025-01-01'
        end_date:
          type: string
          format: date
          description: 合同结束日期
          example: '2025-12-31'
        renewal_type:
          type: integer
          description: 续约类型：1-手动，2-自动
          enum:
          - 1
          - 2
          default: 1
          example: 1
        renewal_notice_days:
          type: integer
          description: 续约提醒天数
          minimum: 1
          maximum: 365
          default: 90
          example: 90
        payment_terms:
          type: string
          description: 付款条件
          maxLength: 100
          example: 月付
        service_level:
          type: string
          description: 服务等级
          maxLength: 100
          example: 专业版
        contract_file_url:
          type: string
          format: uri
          description: 合同文件URL
          example: https://cdn.example.com/contracts/CONT-20250815-0001.pdf
        signed_date:
          type: string
          format: date
          description: 签署日期
          example: '2024-12-15'
    CustomerContractUpdateRequest:
      type: object
      description: 更新客户合同请求
      properties:
        contract_name:
          type: string
          description: 合同名称
          minLength: 1
          maxLength: 200
          example: IT运维服务合同
        contract_amount:
          type: number
          format: float
          description: 合同金额
          minimum: 0
          example: 120000.0
        end_date:
          type: string
          format: date
          description: 合同结束日期
          example: '2025-12-31'
        status:
          type: integer
          description: 状态：1-草稿，2-生效，3-到期，4-终止
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 2
        renewal_type:
          type: integer
          description: 续约类型：1-手动，2-自动
          enum:
          - 1
          - 2
          example: 1
        renewal_notice_days:
          type: integer
          description: 续约提醒天数
          minimum: 1
          maximum: 365
          example: 90
        payment_terms:
          type: string
          description: 付款条件
          maxLength: 100
          example: 月付
        service_level:
          type: string
          description: 服务等级
          maxLength: 100
          example: 专业版
        contract_file_url:
          type: string
          format: uri
          description: 合同文件URL
          example: https://cdn.example.com/contracts/CONT-20250815-0001.pdf
    ContractRenewalRequest:
      type: object
      description: 合同续约请求
      required:
      - new_end_date
      properties:
        new_end_date:
          type: string
          format: date
          description: 新的合同结束日期
          example: '2026-12-31'
        new_amount:
          type: number
          format: float
          description: 新的合同金额
          minimum: 0
          example: 150000.0
        renewal_terms:
          type: string
          description: 续约条款
          example: 按原合同条款续约，金额上调25%
    CustomerTagCreateRequest:
      type: object
      description: 创建客户标签请求
      required:
      - tag_name
      properties:
        tag_name:
          type: string
          description: 标签名称
          minLength: 1
          maxLength: 100
          example: 高价值客户
        tag_type:
          type: integer
          description: 标签类型：1-手动，2-自动，3-系统
          enum:
          - 1
          - 2
          - 3
          default: 1
          example: 1
        tag_category:
          type: string
          description: 标签分类
          maxLength: 50
          example: 价值分类
        tag_value:
          type: string
          description: 标签值
          maxLength: 200
          example: VIP
    CustomerBehaviorAnalysisResponse:
      type: object
      description: 客户行为分析响应
      properties:
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        analysis_period:
          type: string
          description: 分析周期
          example: 3m
        login_behavior:
          type: object
          description: 登录行为分析
          properties:
            total_logins:
              type: integer
              description: 总登录次数
              example: 156
            avg_daily_logins:
              type: number
              format: float
              description: 日均登录次数
              example: 1.73
            login_frequency_trend:
              type: string
              description: 登录频率趋势
              enum:
              - 上升
              - 下降
              - 稳定
              example: 稳定
            peak_hours:
              type: array
              description: 高峰时段
              items:
                type: string
              example:
              - 09:00-11:00
              - 14:00-16:00
        usage_behavior:
          type: object
          description: 使用行为分析
          properties:
            most_used_features:
              type: array
              description: 最常用功能
              items:
                type: object
                properties:
                  feature_name:
                    type: string
                    example: 工单管理
                  usage_count:
                    type: integer
                    example: 89
                  usage_percentage:
                    type: number
                    format: float
                    example: 0.57
            feature_adoption_rate:
              type: number
              format: float
              description: 功能采用率
              minimum: 0
              maximum: 1
              example: 0.75
            session_duration_avg:
              type: number
              format: float
              description: 平均会话时长（分钟）
              example: 45.6
        service_interaction:
          type: object
          description: 服务交互分析
          properties:
            ticket_submission_rate:
              type: number
              format: float
              description: 工单提交频率（次/月）
              example: 2.3
            satisfaction_trend:
              type: string
              description: 满意度趋势
              enum:
              - 上升
              - 下降
              - 稳定
              example: 上升
            communication_preference:
              type: string
              description: 沟通偏好
              example: 邮件
        engagement_score:
          type: number
          format: float
          description: 参与度评分
          minimum: 0
          maximum: 100
          example: 78.5
        behavior_insights:
          type: array
          description: 行为洞察
          items:
            type: string
          example:
          - 客户使用频率稳定，主要集中在工作时间
          - 对新功能接受度较高
          - 偏好邮件沟通方式
    CustomerCommunication:
      type: object
      description: 客户沟通记录信息
      properties:
        communication_id:
          type: integer
          format: int64
          description: 沟通记录ID
          example: 30001
        tenant_id:
          type: integer
          format: int64
          description: 租户ID
          example: 1
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        contact_id:
          type: integer
          format: int64
          description: 联系人ID
          example: 1001
        communication_type:
          type: integer
          description: 沟通类型：1-电话，2-邮件，3-会议，4-在线聊天
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 2
        direction:
          type: integer
          description: 方向：1-呼入，2-呼出
          enum:
          - 1
          - 2
          example: 2
        subject:
          type: string
          description: 主题
          example: 月度服务回顾会议
        content:
          type: string
          description: 沟通内容
          example: 讨论了本月服务质量情况，客户对响应速度表示满意
        duration_minutes:
          type: integer
          description: 持续时间（分钟）
          example: 60
        outcome:
          type: string
          description: 沟通结果
          example: 达成一致
        next_action:
          type: string
          description: 下一步行动
          example: 下月继续跟进服务质量
        sentiment:
          type: integer
          description: 情感倾向：1-负面，2-中性，3-正面
          enum:
          - 1
          - 2
          - 3
          example: 3
        importance:
          type: integer
          description: 重要性：1-低，2-中，3-高
          enum:
          - 1
          - 2
          - 3
          default: 2
          example: 2
        staff_id:
          type: integer
          format: int64
          description: 员工ID
          example: 1001
        staff_name:
          type: string
          description: 员工姓名
          example: 李经理
        communication_date:
          type: string
          format: date-time
          description: 沟通时间
          example: '2025-08-15T14:30:00Z'
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: '2025-08-15T15:00:00Z'
    CustomerCommunicationCreateRequest:
      type: object
      description: 创建沟通记录请求
      required:
      - communication_type
      - direction
      - subject
      - content
      - communication_date
      properties:
        contact_id:
          type: integer
          format: int64
          description: 联系人ID
          example: 1001
        communication_type:
          type: integer
          description: 沟通类型：1-电话，2-邮件，3-会议，4-在线聊天
          enum:
          - 1
          - 2
          - 3
          - 4
          example: 2
        direction:
          type: integer
          description: 方向：1-呼入，2-呼出
          enum:
          - 1
          - 2
          example: 2
        subject:
          type: string
          description: 主题
          minLength: 1
          maxLength: 200
          example: 月度服务回顾会议
        content:
          type: string
          description: 沟通内容
          minLength: 1
          example: 讨论了本月服务质量情况，客户对响应速度表示满意
        duration_minutes:
          type: integer
          description: 持续时间（分钟）
          minimum: 0
          example: 60
        outcome:
          type: string
          description: 沟通结果
          maxLength: 100
          example: 达成一致
        next_action:
          type: string
          description: 下一步行动
          maxLength: 200
          example: 下月继续跟进服务质量
        sentiment:
          type: integer
          description: 情感倾向：1-负面，2-中性，3-正面
          enum:
          - 1
          - 2
          - 3
          example: 3
        importance:
          type: integer
          description: 重要性：1-低，2-中，3-高
          enum:
          - 1
          - 2
          - 3
          default: 2
          example: 2
        communication_date:
          type: string
          format: date-time
          description: 沟通时间
          example: '2025-08-15T14:30:00Z'
    CustomerServiceRecord:
      type: object
      description: 客户服务记录信息
      properties:
        record_id:
          type: integer
          format: int64
          description: 服务记录ID
          example: 40001
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        ticket_id:
          type: string
          description: 关联工单ID
          example: TCK-20250815-0001
        service_type:
          type: string
          description: 服务类型
          example: 故障处理
        service_description:
          type: string
          description: 服务描述
          example: 解决服务器CPU使用率过高问题
        service_duration:
          type: integer
          description: 服务时长（分钟）
          example: 120
        engineer_id:
          type: integer
          format: int64
          description: 工程师ID
          example: 1001
        engineer_name:
          type: string
          description: 工程师姓名
          example: 张工程师
        resolution_time:
          type: integer
          description: 解决时间（分钟）
          example: 90
        satisfaction_score:
          type: number
          format: float
          description: 满意度评分
          minimum: 1
          maximum: 5
          example: 4.5
        sla_met:
          type: boolean
          description: 是否满足SLA
          example: true
        service_date:
          type: string
          format: date-time
          description: 服务时间
          example: '2025-08-15T10:30:00Z'
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: '2025-08-15T16:00:00Z'
    CustomerSatisfactionData:
      type: object
      description: 客户满意度数据
      properties:
        customer_id:
          type: integer
          format: int64
          description: 客户ID
          example: 12345
        period:
          type: string
          description: 统计周期
          example: 3m
        overall_satisfaction:
          type: number
          format: float
          description: 总体满意度
          minimum: 1
          maximum: 5
          example: 4.3
        satisfaction_trend:
          type: string
          description: 满意度趋势
          enum:
          - 上升
          - 下降
          - 稳定
          example: 上升
        service_satisfaction:
          type: object
          description: 服务满意度详情
          properties:
            response_time:
              type: number
              format: float
              description: 响应时间满意度
              example: 4.5
            solution_quality:
              type: number
              format: float
              description: 解决方案质量满意度
              example: 4.2
            communication:
              type: number
              format: float
              description: 沟通满意度
              example: 4.4
            professionalism:
              type: number
              format: float
              description: 专业性满意度
              example: 4.6
        satisfaction_history:
          type: array
          description: 满意度历史
          items:
            type: object
            properties:
              date:
                type: string
                format: date
                example: '2025-08-01'
              score:
                type: number
                format: float
                example: 4.3
        improvement_suggestions:
          type: array
          description: 改进建议
          items:
            type: string
          example:
          - 提高响应速度
          - 加强技术培训
          - 优化沟通流程
