openapi: 3.0.3
info:
  title: IT运维门户系统 API
  version: 1.0.0
  description: 知识库管理系统模块API - 提供知识文档管理、版本控制、协作编辑、搜索推荐等功能

tags:
  - name: knowledge-articles
    description: 知识文档管理
  - name: knowledge-categories
    description: 分类管理
  - name: knowledge-versions
    description: 版本管理
  - name: knowledge-search
    description: 搜索推荐
  - name: knowledge-collaboration
    description: 协作编辑
  - name: knowledge-reviews
    description: 审核流程
  - name: knowledge-attachments
    description: 附件管理
  - name: knowledge-statistics
    description: 统计分析

paths:
  /api/v1/knowledge/articles:
    get:
      tags:
        - knowledge-articles
      summary: 查询知识文档列表
      description: 分页查询知识文档列表，支持多种过滤条件
      operationId: knowledge_list_articles
      parameters:
        - name: category_id
          in: query
          description: 分类ID
          schema:
            type: integer
            format: int64
            example: 101
        - name: tags
          in: query
          description: 标签过滤（多个标签用逗号分隔）
          schema:
            type: string
            example: "Linux,性能优化"
        - name: status
          in: query
          description: 文档状态
          schema:
            type: integer
            enum: [1, 2, 3, 4, 5]
            example: 3
        - name: author_id
          in: query
          description: 作者ID
          schema:
            type: integer
            format: int64
            example: 1001
        - name: keyword
          in: query
          description: 关键词搜索
          schema:
            type: string
            example: "服务器优化"
        - name: date_from
          in: query
          description: 创建时间起始日期
          schema:
            type: string
            format: date
            example: "2024-01-01"
        - name: date_to
          in: query
          description: 创建时间结束日期
          schema:
            type: string
            format: date
            example: "2024-12-31"
        - name: sort
          in: query
          description: 排序方式
          schema:
            type: string
            enum: ["created_at", "updated_at", "view_count", "rating", "title"]
            default: "updated_at"
            example: "updated_at"
        - name: order
          in: query
          description: 排序方向
          schema:
            type: string
            enum: ["asc", "desc"]
            default: "desc"
            example: "desc"
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: size
          in: query
          description: 每页数量
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
            example: 10
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/PagedResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          items:
                            type: array
                            items:
                              $ref: '#/components/schemas/KnowledgeArticleListItem'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '403':
          $ref: '../../global-api-index.yaml#/components/responses/Forbidden'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

    post:
      tags:
        - knowledge-articles
      summary: 创建知识文档
      description: 创建新的知识文档
      operationId: knowledge_create_article
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateKnowledgeArticleRequest'
      responses:
        '200':
          description: 创建成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KnowledgeArticle'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '403':
          $ref: '../../global-api-index.yaml#/components/responses/Forbidden'
        '422':
          $ref: '../../global-api-index.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

  /api/v1/knowledge/articles/{id}:
    get:
      tags:
        - knowledge-articles
      summary: 获取知识文档详情
      description: 根据ID获取知识文档的详细信息
      operationId: knowledge_get_article
      parameters:
        - name: id
          in: path
          required: true
          description: 文档ID
          schema:
            type: integer
            format: int64
            example: 12345
        - name: include_content
          in: query
          description: 是否包含文档内容
          schema:
            type: boolean
            default: true
            example: true
        - name: track_view
          in: query
          description: 是否记录浏览次数
          schema:
            type: boolean
            default: true
            example: true
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KnowledgeArticle'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '403':
          $ref: '../../global-api-index.yaml#/components/responses/Forbidden'
        '404':
          $ref: '../../global-api-index.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

    put:
      tags:
        - knowledge-articles
      summary: 更新知识文档
      description: 全量更新知识文档信息
      operationId: knowledge_update_article
      parameters:
        - name: id
          in: path
          required: true
          description: 文档ID
          schema:
            type: integer
            format: int64
            example: 12345
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateKnowledgeArticleRequest'
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KnowledgeArticle'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '403':
          $ref: '../../global-api-index.yaml#/components/responses/Forbidden'
        '404':
          $ref: '../../global-api-index.yaml#/components/responses/NotFound'
        '409':
          $ref: '../../global-api-index.yaml#/components/responses/Conflict'
        '422':
          $ref: '../../global-api-index.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

    patch:
      tags:
        - knowledge-articles
      summary: 部分更新知识文档
      description: 部分更新知识文档的特定字段
      operationId: knowledge_patch_article
      parameters:
        - name: id
          in: path
          required: true
          description: 文档ID
          schema:
            type: integer
            format: int64
            example: 12345
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchKnowledgeArticleRequest'
      responses:
        '200':
          description: 更新成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KnowledgeArticle'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '403':
          $ref: '../../global-api-index.yaml#/components/responses/Forbidden'
        '404':
          $ref: '../../global-api-index.yaml#/components/responses/NotFound'
        '409':
          $ref: '../../global-api-index.yaml#/components/responses/Conflict'
        '422':
          $ref: '../../global-api-index.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

    delete:
      tags:
        - knowledge-articles
      summary: 删除知识文档
      description: 删除指定的知识文档（软删除）
      operationId: knowledge_delete_article
      parameters:
        - name: id
          in: path
          required: true
          description: 文档ID
          schema:
            type: integer
            format: int64
            example: 12345
        - name: force
          in: query
          description: 是否强制删除（物理删除）
          schema:
            type: boolean
            default: false
            example: false
      responses:
        '200':
          description: 删除成功
          content:
            application/json:
              schema:
                $ref: '../../global-api-index.yaml#/components/schemas/ApiResponse'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '403':
          $ref: '../../global-api-index.yaml#/components/responses/Forbidden'
        '404':
          $ref: '../../global-api-index.yaml#/components/responses/NotFound'
        '409':
          $ref: '../../global-api-index.yaml#/components/responses/Conflict'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

  /api/v1/knowledge/search:
    get:
      tags:
        - knowledge-search
      summary: 全文搜索知识文档
      description: 基于Elasticsearch的高性能全文搜索
      operationId: knowledge_search_articles
      parameters:
        - name: q
          in: query
          required: true
          description: 搜索关键词
          schema:
            type: string
            example: "Linux性能优化"
        - name: category_id
          in: query
          description: 分类ID过滤
          schema:
            type: integer
            format: int64
            example: 101
        - name: tags
          in: query
          description: 标签过滤（多个标签用逗号分隔）
          schema:
            type: string
            example: "Linux,性能优化"
        - name: author_id
          in: query
          description: 作者ID过滤
          schema:
            type: integer
            format: int64
            example: 1001
        - name: date_from
          in: query
          description: 创建时间起始日期
          schema:
            type: string
            format: date
            example: "2024-01-01"
        - name: date_to
          in: query
          description: 创建时间结束日期
          schema:
            type: string
            format: date
            example: "2024-12-31"
        - name: sort
          in: query
          description: 排序方式
          schema:
            type: string
            enum: ["relevance", "created_at", "updated_at", "view_count", "rating"]
            default: "relevance"
            example: "relevance"
        - name: highlight
          in: query
          description: 是否高亮显示搜索关键词
          schema:
            type: boolean
            default: true
            example: true
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: size
          in: query
          description: 每页数量
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 10
            example: 10
      responses:
        '200':
          description: 搜索成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/PagedResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          items:
                            type: array
                            items:
                              $ref: '#/components/schemas/KnowledgeSearchResult'
                          took:
                            type: integer
                            description: 搜索耗时（毫秒）
                            example: 45
                          aggregations:
                            $ref: '#/components/schemas/SearchAggregations'
                          suggestions:
                            type: array
                            items:
                              type: string
                            example: ["Linux系统优化", "服务器监控", "性能调优工具"]
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

  /api/v1/knowledge/search/suggest:
    get:
      tags:
        - knowledge-search
      summary: 搜索建议
      description: 获取搜索关键词建议和自动补全
      operationId: knowledge_search_suggest
      parameters:
        - name: q
          in: query
          required: true
          description: 搜索关键词前缀
          schema:
            type: string
            example: "Linux"
        - name: size
          in: query
          description: 建议数量
          schema:
            type: integer
            minimum: 1
            maximum: 20
            default: 10
            example: 10
      responses:
        '200':
          description: 获取建议成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          suggestions:
                            type: array
                            items:
                              $ref: '#/components/schemas/SearchSuggestion'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

  /api/v1/knowledge/categories:
    get:
      tags:
        - knowledge-categories
      summary: 获取分类列表
      description: 获取知识分类列表，支持树形结构
      operationId: knowledge_list_categories
      parameters:
        - name: parent_id
          in: query
          description: 父分类ID（获取子分类）
          schema:
            type: integer
            format: int64
            example: 100
        - name: level
          in: query
          description: 分类层级
          schema:
            type: integer
            minimum: 1
            maximum: 5
            example: 1
        - name: include_stats
          in: query
          description: 是否包含统计信息
          schema:
            type: boolean
            default: false
            example: true
        - name: tree_format
          in: query
          description: 是否返回树形结构
          schema:
            type: boolean
            default: false
            example: true
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/KnowledgeCategory'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

    post:
      tags:
        - knowledge-categories
      summary: 创建分类
      description: 创建新的知识分类
      operationId: knowledge_create_category
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateKnowledgeCategoryRequest'
      responses:
        '200':
          description: 创建成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KnowledgeCategory'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '403':
          $ref: '../../global-api-index.yaml#/components/responses/Forbidden'
        '422':
          $ref: '../../global-api-index.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

  /api/v1/knowledge/articles/{id}/versions:
    get:
      tags:
        - knowledge-versions
      summary: 获取文档版本列表
      description: 获取指定文档的所有版本信息
      operationId: knowledge_list_versions
      parameters:
        - name: id
          in: path
          required: true
          description: 文档ID
          schema:
            type: integer
            format: int64
            example: 12345
        - name: page
          in: query
          description: 页码
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: size
          in: query
          description: 每页数量
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 20
            example: 20
      responses:
        '200':
          description: 获取成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/PagedResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          items:
                            type: array
                            items:
                              $ref: '#/components/schemas/KnowledgeVersion'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '403':
          $ref: '../../global-api-index.yaml#/components/responses/Forbidden'
        '404':
          $ref: '../../global-api-index.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

    post:
      tags:
        - knowledge-versions
      summary: 创建文档版本
      description: 为指定文档创建新版本
      operationId: knowledge_create_version
      parameters:
        - name: id
          in: path
          required: true
          description: 文档ID
          schema:
            type: integer
            format: int64
            example: 12345
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateKnowledgeVersionRequest'
      responses:
        '200':
          description: 创建成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '../../global-api-index.yaml#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KnowledgeVersion'
        '400':
          $ref: '../../global-api-index.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../global-api-index.yaml#/components/responses/Unauthorized'
        '403':
          $ref: '../../global-api-index.yaml#/components/responses/Forbidden'
        '404':
          $ref: '../../global-api-index.yaml#/components/responses/NotFound'
        '422':
          $ref: '../../global-api-index.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../global-api-index.yaml#/components/responses/InternalServerError'

components:
  schemas:
    KnowledgeArticle:
      type: object
      description: 知识文档完整信息
      properties:
        id:
          type: integer
          format: int64
          description: 文档ID
          example: 12345
        title:
          type: string
          maxLength: 200
          description: 文档标题
          example: "Linux服务器性能优化完整指南"
        content:
          type: string
          description: 富文本HTML内容
          example: "<h1>性能优化概述</h1><p>本文档详细介绍Linux服务器性能优化的方法...</p>"
        summary:
          type: string
          maxLength: 500
          description: 文档摘要
          example: "全面介绍Linux服务器性能优化的方法、工具和最佳实践"
        category:
          $ref: '#/components/schemas/KnowledgeCategoryInfo'
        tags:
          type: array
          items:
            type: string
          description: 标签列表
          example: ["Linux", "性能优化", "服务器", "运维"]
        keywords:
          type: string
          maxLength: 500
          description: 关键词
          example: "Linux,性能优化,服务器,CPU,内存,磁盘,网络"
        author:
          $ref: '#/components/schemas/AuthorInfo'
        status:
          type: integer
          enum: [1, 2, 3, 4, 5]
          description: "状态：1-草稿，2-审核中，3-已发布，4-已下线，5-争议中"
          example: 3
        visibility:
          type: integer
          enum: [1, 2, 3]
          description: "可见性：1-公开，2-内部，3-私有"
          example: 1
        version_no:
          type: string
          pattern: "^\\d+\\.\\d+\\.\\d+$"
          description: 当前版本号
          example: "1.2.0"
        statistics:
          $ref: '#/components/schemas/ArticleStatistics'
        quality_metrics:
          $ref: '#/components/schemas/QualityMetrics'
        timestamps:
          $ref: '#/components/schemas/ArticleTimestamps'
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/AttachmentInfo'
        metadata:
          $ref: '#/components/schemas/ArticleMetadata'
      required:
        - id
        - title
        - status
        - author
        - timestamps

    KnowledgeArticleListItem:
      type: object
      description: 知识文档列表项（简化信息）
      properties:
        id:
          type: integer
          format: int64
          description: 文档ID
          example: 12345
        title:
          type: string
          description: 文档标题
          example: "Linux服务器性能优化完整指南"
        summary:
          type: string
          description: 文档摘要
          example: "全面介绍Linux服务器性能优化的方法、工具和最佳实践"
        category_name:
          type: string
          description: 分类名称
          example: "系统运维"
        tags:
          type: array
          items:
            type: string
          description: 标签列表
          example: ["Linux", "性能优化", "服务器"]
        author_name:
          type: string
          description: 作者姓名
          example: "张工程师"
        status:
          type: integer
          enum: [1, 2, 3, 4, 5]
          description: "状态：1-草稿，2-审核中，3-已发布，4-已下线，5-争议中"
          example: 3
        view_count:
          type: integer
          minimum: 0
          description: 浏览次数
          example: 1256
        like_count:
          type: integer
          minimum: 0
          description: 点赞次数
          example: 89
        rating:
          type: number
          format: float
          minimum: 0
          maximum: 5
          description: 评分
          example: 4.7
        quality_score:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: 质量评分
          example: 92.5
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-08-01T10:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: "2024-08-10T15:30:00Z"
      required:
        - id
        - title
        - status
        - author_name
        - created_at
        - updated_at

    CreateKnowledgeArticleRequest:
      type: object
      description: 创建知识文档请求
      properties:
        title:
          type: string
          maxLength: 200
          description: 文档标题
          example: "Linux服务器性能优化完整指南"
        content:
          type: string
          description: 富文本HTML内容
          example: "<h1>性能优化概述</h1><p>本文档详细介绍Linux服务器性能优化的方法...</p>"
        summary:
          type: string
          maxLength: 500
          description: 文档摘要
          example: "全面介绍Linux服务器性能优化的方法、工具和最佳实践"
        category_id:
          type: integer
          format: int64
          description: 分类ID
          example: 101
        tags:
          type: array
          items:
            type: string
          description: 标签列表
          example: ["Linux", "性能优化", "服务器", "运维"]
        keywords:
          type: string
          maxLength: 500
          description: 关键词
          example: "Linux,性能优化,服务器,CPU,内存,磁盘,网络"
        visibility:
          type: integer
          enum: [1, 2, 3]
          description: "可见性：1-公开，2-内部，3-私有"
          default: 1
          example: 1
        is_template:
          type: boolean
          description: 是否为模板
          default: false
          example: false
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/AttachmentUpload'
          description: 附件列表
        metadata:
          $ref: '#/components/schemas/ArticleMetadata'
      required:
        - title
        - content
        - category_id

    UpdateKnowledgeArticleRequest:
      type: object
      description: 更新知识文档请求
      properties:
        title:
          type: string
          maxLength: 200
          description: 文档标题
          example: "Linux服务器性能优化完整指南"
        content:
          type: string
          description: 富文本HTML内容
          example: "<h1>性能优化概述</h1><p>本文档详细介绍Linux服务器性能优化的方法...</p>"
        summary:
          type: string
          maxLength: 500
          description: 文档摘要
          example: "全面介绍Linux服务器性能优化的方法、工具和最佳实践"
        category_id:
          type: integer
          format: int64
          description: 分类ID
          example: 101
        tags:
          type: array
          items:
            type: string
          description: 标签列表
          example: ["Linux", "性能优化", "服务器", "运维"]
        keywords:
          type: string
          maxLength: 500
          description: 关键词
          example: "Linux,性能优化,服务器,CPU,内存,磁盘,网络"
        visibility:
          type: integer
          enum: [1, 2, 3]
          description: "可见性：1-公开，2-内部，3-私有"
          example: 1
        metadata:
          $ref: '#/components/schemas/ArticleMetadata'
      required:
        - title
        - content
        - category_id

    PatchKnowledgeArticleRequest:
      type: object
      description: 部分更新知识文档请求
      properties:
        title:
          type: string
          maxLength: 200
          description: 文档标题
          example: "Linux服务器性能优化完整指南"
        content:
          type: string
          description: 富文本HTML内容
          example: "<h1>性能优化概述</h1><p>本文档详细介绍Linux服务器性能优化的方法...</p>"
        summary:
          type: string
          maxLength: 500
          description: 文档摘要
          example: "全面介绍Linux服务器性能优化的方法、工具和最佳实践"
        category_id:
          type: integer
          format: int64
          description: 分类ID
          example: 101
        tags:
          type: array
          items:
            type: string
          description: 标签列表
          example: ["Linux", "性能优化", "服务器", "运维"]
        keywords:
          type: string
          maxLength: 500
          description: 关键词
          example: "Linux,性能优化,服务器,CPU,内存,磁盘,网络"
        visibility:
          type: integer
          enum: [1, 2, 3]
          description: "可见性：1-公开，2-内部，3-私有"
          example: 1
        status:
          type: integer
          enum: [1, 2, 3, 4, 5]
          description: "状态：1-草稿，2-审核中，3-已发布，4-已下线，5-争议中"
          example: 3

    KnowledgeCategory:
      type: object
      description: 知识分类信息
      properties:
        id:
          type: integer
          format: int64
          description: 分类ID
          example: 101
        category_name:
          type: string
          maxLength: 100
          description: 分类名称
          example: "系统运维"
        category_code:
          type: string
          maxLength: 50
          description: 分类编码
          example: "system_ops"
        parent_id:
          type: integer
          format: int64
          nullable: true
          description: 父分类ID
          example: 100
        description:
          type: string
          description: 分类描述
          example: "系统运维相关的技术文档和操作指南"
        icon:
          type: string
          maxLength: 100
          description: 分类图标
          example: "icon-server"
        color:
          type: string
          maxLength: 20
          description: 分类颜色
          example: "#1890ff"
        level_depth:
          type: integer
          minimum: 1
          maximum: 5
          description: 层级深度
          example: 2
        path_names:
          type: string
          maxLength: 500
          description: 路径名称串
          example: "技术文档/系统运维"
        article_count:
          type: integer
          minimum: 0
          description: 文档数量
          example: 156
        total_views:
          type: integer
          minimum: 0
          description: 总浏览量
          example: 25680
        avg_rating:
          type: number
          format: float
          minimum: 0
          maximum: 5
          description: 平均评分
          example: 4.3
        sort_order:
          type: integer
          description: 排序权重
          example: 10
        is_active:
          type: boolean
          description: 是否启用
          example: true
        access_level:
          type: integer
          enum: [1, 2, 3]
          description: "访问级别：1-公开，2-内部，3-受限"
          example: 1
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-01-01T09:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: "2024-08-14T14:30:00Z"
        children:
          type: array
          items:
            $ref: '#/components/schemas/KnowledgeCategory'
          description: 子分类列表（树形结构时使用）
      required:
        - id
        - category_name
        - category_code
        - level_depth
        - is_active
        - created_at
        - updated_at

    CreateKnowledgeCategoryRequest:
      type: object
      description: 创建知识分类请求
      properties:
        category_name:
          type: string
          maxLength: 100
          description: 分类名称
          example: "系统运维"
        category_code:
          type: string
          maxLength: 50
          description: 分类编码
          example: "system_ops"
        parent_id:
          type: integer
          format: int64
          nullable: true
          description: 父分类ID
          example: 100
        description:
          type: string
          description: 分类描述
          example: "系统运维相关的技术文档和操作指南"
        icon:
          type: string
          maxLength: 100
          description: 分类图标
          example: "icon-server"
        color:
          type: string
          maxLength: 20
          description: 分类颜色
          example: "#1890ff"
        sort_order:
          type: integer
          description: 排序权重
          default: 0
          example: 10
        access_level:
          type: integer
          enum: [1, 2, 3]
          description: "访问级别：1-公开，2-内部，3-受限"
          default: 1
          example: 1
      required:
        - category_name
        - category_code

    KnowledgeVersion:
      type: object
      description: 知识文档版本信息
      properties:
        id:
          type: integer
          format: int64
          description: 版本ID
          example: 5001
        article_id:
          type: integer
          format: int64
          description: 文档ID
          example: 12345
        version_no:
          type: string
          pattern: "^\\d+\\.\\d+\\.\\d+$"
          description: 版本号
          example: "1.2.0"
        version_type:
          type: integer
          enum: [1, 2, 3]
          description: "版本类型：1-主要，2-次要，3-修订"
          example: 2
        title:
          type: string
          maxLength: 200
          description: 版本标题
          example: "Linux服务器性能优化完整指南"
        content:
          type: string
          description: 版本内容
          example: "<h1>性能优化概述</h1><p>本文档详细介绍...</p>"
        change_log:
          type: string
          description: 变更日志
          example: "新增Docker容器性能优化章节，修复网络配置示例错误"
        change_summary:
          type: string
          maxLength: 500
          description: 变更摘要
          example: "增加容器化环境优化内容，修复配置示例"
        file_size:
          type: integer
          format: int64
          description: 内容大小（字节）
          example: 51200
        word_count:
          type: integer
          description: 字数统计
          example: 8500
        change_count:
          type: integer
          description: 变更数量
          example: 15
        created_by:
          type: integer
          format: int64
          description: 创建人ID
          example: 1001
        created_by_name:
          type: string
          description: 创建人姓名
          example: "张工程师"
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-08-10T15:30:00Z"
        version_tags:
          type: array
          items:
            type: string
          description: 版本标签
          example: ["stable", "reviewed"]
        notes:
          type: string
          description: 版本备注
          example: "经过专家审核的稳定版本"
      required:
        - id
        - article_id
        - version_no
        - version_type
        - title
        - created_by
        - created_at

    CreateKnowledgeVersionRequest:
      type: object
      description: 创建知识版本请求
      properties:
        version_type:
          type: integer
          enum: [1, 2, 3]
          description: "版本类型：1-主要，2-次要，3-修订"
          default: 3
          example: 2
        change_log:
          type: string
          description: 变更日志
          example: "新增Docker容器性能优化章节，修复网络配置示例错误"
        change_summary:
          type: string
          maxLength: 500
          description: 变更摘要
          example: "增加容器化环境优化内容，修复配置示例"
        version_tags:
          type: array
          items:
            type: string
          description: 版本标签
          example: ["stable", "reviewed"]
        notes:
          type: string
          description: 版本备注
          example: "经过专家审核的稳定版本"
        auto_increment:
          type: boolean
          description: 是否自动递增版本号
          default: true
          example: true
      required:
        - change_log

    KnowledgeSearchResult:
      type: object
      description: 知识搜索结果项
      properties:
        id:
          type: integer
          format: int64
          description: 文档ID
          example: 12345
        title:
          type: string
          description: 文档标题
          example: "Linux服务器性能优化完整指南"
        summary:
          type: string
          description: 文档摘要
          example: "全面介绍Linux服务器性能优化的方法、工具和最佳实践"
        category_name:
          type: string
          description: 分类名称
          example: "系统运维"
        category_path:
          type: string
          description: 分类路径
          example: "技术文档/系统运维"
        tags:
          type: array
          items:
            type: string
          description: 标签列表
          example: ["Linux", "性能优化", "服务器"]
        author_name:
          type: string
          description: 作者姓名
          example: "张工程师"
        author_avatar:
          type: string
          description: 作者头像URL
          example: "https://cdn.example.com/avatar/1001.jpg"
        view_count:
          type: integer
          minimum: 0
          description: 浏览次数
          example: 1256
        like_count:
          type: integer
          minimum: 0
          description: 点赞次数
          example: 89
        rating:
          type: number
          format: float
          minimum: 0
          maximum: 5
          description: 评分
          example: 4.7
        quality_score:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: 质量评分
          example: 92.5
        relevance_score:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: 相关性评分
          example: 95.6
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: "2024-08-10T15:30:00Z"
        highlights:
          type: object
          description: 高亮显示的搜索匹配内容
          properties:
            title:
              type: array
              items:
                type: string
              description: 标题中的高亮片段
              example: ["<em>Linux</em>服务器<em>性能优化</em>完整指南"]
            content:
              type: array
              items:
                type: string
              description: 内容中的高亮片段
              example: ["...CPU<em>性能优化</em>是<em>Linux</em>服务器调优的重要环节..."]
            summary:
              type: array
              items:
                type: string
              description: 摘要中的高亮片段
              example: ["全面介绍<em>Linux</em>服务器<em>性能优化</em>的方法..."]
      required:
        - id
        - title
        - category_name
        - author_name
        - relevance_score
        - updated_at

    SearchAggregations:
      type: object
      description: 搜索聚合统计信息
      properties:
        categories:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                description: 分类名称
                example: "系统运维"
              count:
                type: integer
                description: 文档数量
                example: 89
          description: 分类统计
        tags:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                description: 标签名称
                example: "Linux"
              count:
                type: integer
                description: 文档数量
                example: 67
          description: 标签统计
        authors:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                description: 作者姓名
                example: "张工程师"
              count:
                type: integer
                description: 文档数量
                example: 23
          description: 作者统计
        date_ranges:
          type: array
          items:
            type: object
            properties:
              range:
                type: string
                description: 时间范围
                example: "最近一个月"
              count:
                type: integer
                description: 文档数量
                example: 45
          description: 时间范围统计

    SearchSuggestion:
      type: object
      description: 搜索建议项
      properties:
        text:
          type: string
          description: 建议文本
          example: "Linux系统优化"
        type:
          type: string
          enum: ["keyword", "title", "tag", "category"]
          description: 建议类型
          example: "keyword"
        score:
          type: number
          format: float
          description: 建议评分
          example: 0.95
        count:
          type: integer
          description: 相关文档数量
          example: 156
        highlight:
          type: string
          description: 高亮显示的建议文本
          example: "<em>Linux</em>系统优化"
      required:
        - text
        - type
        - score

    # 辅助Schema定义
    KnowledgeCategoryInfo:
      type: object
      description: 知识分类基本信息
      properties:
        id:
          type: integer
          format: int64
          description: 分类ID
          example: 101
        name:
          type: string
          description: 分类名称
          example: "系统运维"
        path:
          type: string
          description: 分类路径
          example: "技术文档/系统运维"
      required:
        - id
        - name

    AuthorInfo:
      type: object
      description: 作者信息
      properties:
        id:
          type: integer
          format: int64
          description: 作者ID
          example: 1001
        name:
          type: string
          description: 作者姓名
          example: "张工程师"
        avatar:
          type: string
          description: 作者头像URL
          example: "https://cdn.example.com/avatar/1001.jpg"
        title:
          type: string
          description: 作者职位
          example: "高级运维工程师"
        department:
          type: string
          description: 所属部门
          example: "运维部"
      required:
        - id
        - name

    ArticleStatistics:
      type: object
      description: 文档统计信息
      properties:
        view_count:
          type: integer
          minimum: 0
          description: 浏览次数
          example: 1256
        like_count:
          type: integer
          minimum: 0
          description: 点赞次数
          example: 89
        use_count:
          type: integer
          minimum: 0
          description: 使用次数
          example: 234
        comment_count:
          type: integer
          minimum: 0
          description: 评论次数
          example: 23
        rating:
          type: number
          format: float
          minimum: 0
          maximum: 5
          description: 评分
          example: 4.7
        rating_count:
          type: integer
          minimum: 0
          description: 评分人数
          example: 156
      required:
        - view_count
        - like_count
        - rating

    QualityMetrics:
      type: object
      description: 质量评估指标
      properties:
        quality_score:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: 综合质量评分
          example: 92.5
        completeness_score:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: 完整性评分
          example: 95.0
        accuracy_score:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: 准确性评分
          example: 90.0
        timeliness_score:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: 时效性评分
          example: 88.0
        usability_score:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: 可用性评分
          example: 94.0
      required:
        - quality_score

    ArticleTimestamps:
      type: object
      description: 文档时间信息
      properties:
        created_at:
          type: string
          format: date-time
          description: 创建时间
          example: "2024-08-01T10:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: 更新时间
          example: "2024-08-10T15:30:00Z"
        published_at:
          type: string
          format: date-time
          nullable: true
          description: 发布时间
          example: "2024-08-02T09:00:00Z"
        last_reviewed_at:
          type: string
          format: date-time
          nullable: true
          description: 最后审核时间
          example: "2024-08-09T14:00:00Z"
      required:
        - created_at
        - updated_at

    AttachmentInfo:
      type: object
      description: 附件信息
      properties:
        id:
          type: integer
          format: int64
          description: 附件ID
          example: 5001
        file_name:
          type: string
          description: 文件名
          example: "performance_script.sh"
        file_type:
          type: string
          description: 文件类型
          example: "application/x-sh"
        file_size:
          type: integer
          format: int64
          description: 文件大小（字节）
          example: 2048
        download_url:
          type: string
          description: 下载链接
          example: "https://cdn.example.com/attachments/5001"
        upload_time:
          type: string
          format: date-time
          description: 上传时间
          example: "2024-08-01T10:30:00Z"
      required:
        - id
        - file_name
        - file_type
        - file_size
        - download_url

    AttachmentUpload:
      type: object
      description: 附件上传信息
      properties:
        file_name:
          type: string
          description: 文件名
          example: "performance_script.sh"
        file_type:
          type: string
          description: 文件类型
          example: "application/x-sh"
        file_size:
          type: integer
          format: int64
          description: 文件大小（字节）
          example: 2048
        file_content:
          type: string
          format: byte
          description: Base64编码的文件内容
          example: "IyEvYmluL2Jhc2gKZWNobyAiSGVsbG8gV29ybGQi"
      required:
        - file_name
        - file_type
        - file_size
        - file_content

    ArticleMetadata:
      type: object
      description: 文档元数据
      properties:
        difficulty_level:
          type: string
          enum: ["beginner", "intermediate", "advanced", "expert"]
          description: 难度级别
          example: "intermediate"
        estimated_read_time:
          type: integer
          minimum: 1
          description: 预估阅读时间（分钟）
          example: 15
        target_audience:
          type: array
          items:
            type: string
          description: 目标受众
          example: ["运维工程师", "系统管理员"]
        prerequisites:
          type: array
          items:
            type: string
          description: 前置知识要求
          example: ["Linux基础", "Shell脚本"]
        related_tools:
          type: array
          items:
            type: string
          description: 相关工具
          example: ["htop", "iotop", "netstat"]
        update_frequency:
          type: string
          enum: ["daily", "weekly", "monthly", "quarterly", "yearly", "as_needed"]
          description: 更新频率
          example: "monthly"
